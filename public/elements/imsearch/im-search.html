<link rel="import" href="/platform/bower_components/polymer/polymer.html">
<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<link rel="import" href="../display-item/display-item.html">

<polymer-element name="im-search" extends="div" >
    <template>
        <style>
        </style>
        <div>
            <template repeat="{{item in items}}">
                <display-item item="{{item}}"></display-item>
            </template>
        </div>
    </template>
    <script>
        (function(){
            var serverUrl = undefined;
            Polymer('im-search', {
                items : [],
                ready : function(){

                },

                initSearch : function(url) {
                    serverUrl = url;
                }
                ,

                searchMessageSingleChannel : function(keyword, channel){

                },

                searchMessageAllChannel : function(keyword){
                    var self = this;
                    $.get(serverUrl + '/api/messages?q=' + keyword).done(function (messages) {
                        self.items = [];
                        messages.forEach(function(msg) {
                            self.items.push({
                                type : 'message',
                                value : msg
                            });
                        });
                    });
                }

            });
        })();

    </script>

</polymer-element>
